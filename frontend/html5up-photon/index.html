<!DOCTYPE HTML>
<html>
	<head>
		<title>API Testing Interface</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Header -->
		<header id="header">
			<h1>API Test Platform</h1>
			<p>A lightweight frontend to run API test cases</p>
		</header>

		<!-- Main Form Section -->
        <section id="test-form-section">
        	<div class="inner">
        		<header class="major">
        			<h2>Run a Test Case</h2>
        		</header>

        		<form id="test-form">
        			<div class="fields">
        				<div class="field">
        					<label for="testcase">Enter Test Case (JSON or text)</label>
        					<textarea name="testcase" id="testcase" rows="6" placeholder='{"input": "value"}'></textarea>
        				</div>
        				<div class="field">
        					<label for="file-upload">Or Upload JSON File</label>
        					<input type="file" id="file-upload" accept=".json" />
        				</div>
        			</div>
        			<ul class="actions">
        				<li><input type="submit" value="Run Test Case" class="primary" /></li>
        			</ul>
        		</form>

        		<div id="result"></div>
				<div id="resultBox" class="result-box"></div>
        	</div>
        </section>

		<!-- Footer -->
		<footer id="footer" class="wrapper style1-alt">
			<div class="inner">
				<ul class="menu">
					<li>&copy; API Test Tool. All rights reserved.</li><li>Design: Photon Template by HTML5 UP</li>
				</ul>
			</div>
		</footer>

		<!-- Scripts -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/jquery.scrolly.min.js"></script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>

		<!-- Custom JS -->
        <script>
          document.getElementById("test-form").addEventListener("submit", async function (event) {
            event.preventDefault();

            const fileInput = document.getElementById("file-upload");
            const manualInput = document.getElementById("testcase").value;
            const resultBox = document.getElementById("resultBox");

            let testData;

            if (fileInput.files.length > 0) {
              const file = fileInput.files[0];
              const text = await file.text();
              try {
                testData = JSON.parse(text);
              } catch (err) {
                resultBox.innerHTML = `<div class="error">❌ Invalid JSON file.</div>`;
                return;
              }
            } else if (manualInput.trim() !== "") {
              try {
                testData = JSON.parse(manualInput);
              } catch (err) {
                resultBox.innerHTML = `<div class="error">❌ Invalid manual JSON input.</div>`;
                return;
              }
            } else {
              resultBox.innerHTML = `<div class="error">❌ Please provide a test case.</div>`;
              return;
            }

            // Simulated test output (replace with real backend call later)
            const fakeApiResponse = {
              url: testData.url || "http://localhost:8000/api/example",
              method: testData.method || "POST",
              tested: testData.assertions || ["status", "response body"],
              passed: true,
              message: "All assertions passed.",
              execution_time: "112ms"
            };

            resultBox.innerHTML = `
              <div class="test-result ${fakeApiResponse.passed ? "success" : "error"}">
                <h3>${fakeApiResponse.passed ? "✅ Test Passed" : "❌ Test Failed"}</h3>
                <p><strong>URL Tested:</strong> ${fakeApiResponse.url}</p>
                <p><strong>Method:</strong> ${fakeApiResponse.method}</p>
                <p><strong>Aspects Tested:</strong> ${fakeApiResponse.tested.join(", ")}</p>
                <p><strong>Execution Time:</strong> ${fakeApiResponse.execution_time}</p>
                <p><strong>Message:</strong> ${fakeApiResponse.message}</p>
              </div>
            `;
          });
        </script>



	</body>
</html>
